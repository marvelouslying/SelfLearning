```python
# 问题1：残差定义的推导
print("="*50)
print("问题1：残差定义的推导")
print("="*50)
```

    ==================================================
    问题1：残差定义的推导
    ==================================================
    

%%latex
\usepackage{amsmath,amssymb} % 加载数学符号库

残差的核心定义为：$ e_t = Y_t - \hat{Y}_t $，其中拟合值 $ \hat{Y}_t = \hat{\beta}_0 + \hat{\beta}_1 X_t $。

### 步骤1：代入截距估计至拟合值公式
OLS截距估计结果为：$ \hat{\beta}_0 = \bar{Y} - \hat{\beta}_1 \bar{X} $（对截距求导并令导数为0推导），将其代入拟合值公式：
\[
\hat{Y}_t = (\bar{Y} - \hat{\beta}_1 \bar{X}) + \hat{\beta}_1 X_t
\]

### 步骤2：代入残差定义并整理
将上述拟合值代入残差定义 $ e_t = Y_t - \hat{Y}_t $，展开并化简：
\[
e_t = Y_t - \left( \bar{Y} - \hat{\beta}_1 \bar{X} + \hat{\beta}_1 X_t \right) = (Y_t - \bar{Y}) - \hat{\beta}_1 (X_t - \bar{X})
\]

### 步骤3：用中心化变量简化
根据中心化变量定义：
- $ y_t = Y_t - \bar{Y} $（Y的中心化，反映Y_t偏离均值的波动）
- $ x_t = X_t - \bar{X} $（X的中心化）

最终残差可简化为：
\[
e_t = y_t - \hat{\beta}_1 x_t
\]


```python
# 问题2：∑x_t=0的原因及中心化后μ的期望
print("\n" + "="*50)
print("问题2：∑x_t=0的原因及中心化后μ的期望")
print("="*50)
```

    
    ==================================================
    问题2：∑x_t=0的原因及中心化后μ的期望
    ==================================================
    

%%latex
\usepackage{amsmath,amssymb}

### （1）∑x_t = 0的推导
中心化变量定义：$ x_t = X_t - \bar{X} $，其中 $ \bar{X} = \frac{1}{T} \sum_{t=1}^T X_t $（样本均值）。

对$ x_t $求和：
\[
\sum_{t=1}^T x_t = \sum_{t=1}^T (X_t - \bar{X}) = \sum_{t=1}^T X_t - \sum_{t=1}^T \bar{X}
\]

关键性质应用：
1. $ \bar{X} $与t无关，故$ \sum_{t=1}^T \bar{X} = T \cdot \bar{X} $
2. 样本均值定义：$ \sum_{t=1}^T X_t = T \cdot \bar{X} $

代入后化简：
\[
\sum_{t=1}^T x_t = T \bar{X} - T \bar{X} = 0
\]
（注：此为数学必然结果，与数据无关）


### （2）中心化后μ的期望为0
原模型假设：$ \mathbb{E}[\mu_t] = 0 $（经典线性回归零均值误差假设）。  
令中心化误差 $ \tilde{\mu}_t = \mu_t - \bar{\mu} $（$ \bar{\mu} = \frac{1}{T} \sum_{t=1}^T \mu_t $），计算其期望：

\[
\mathbb{E}[\tilde{\mu}_t] = \mathbb{E}[\mu_t - \bar{\mu}] = \mathbb{E}[\mu_t] - \mathbb{E}[\bar{\mu}]
\]

分步计算：
1. 由原假设：$ \mathbb{E}[\mu_t] = 0 $
2. 对$ \bar{\mu} $求期望（利用期望线性性质）：
\[
\mathbb{E}[\bar{\mu}] = \frac{1}{T} \sum_{t=1}^T \mathbb{E}[\mu_t] = \frac{1}{T} \cdot T \cdot 0 = 0
\]

最终结果：
\[
\mathbb{E}[\tilde{\mu}_t] = 0 - 0 = 0
\]


```python
# 问题3：推导β₁̂ = ∑x_t y_t / ∑x_t²
print("\n" + "="*50)
print("问题3：推导β₁̂ = ∑x_t y_t / ∑x_t²")
print("="*50)
```

    
    ==================================================
    问题3：推导β₁̂ = ∑x_t y_t / ∑x_t²
    ==================================================
    

%%latex
\usepackage{amsmath,amssymb}

### 步骤1：明确原正规方程
对$ \hat{\beta}_1 $求导后得到的正规方程为：
\[
\sum_{t=1}^T (Y_t - \hat{\beta}_0 - \hat{\beta}_1 X_t) X_t = 0 \tag{1}
\]

### 步骤2：代入关键变量
结合以下定义/估计式：
- 中心化变量：$ Y_t = \bar{Y} + y_t $，$ X_t = \bar{X} + x_t $
- 截距估计：$ \hat{\beta}_0 = \bar{Y} - \hat{\beta}_1 \bar{X} $

将其代入方程（1）左边：
\[
\sum_{t=1}^T \left[ (\bar{Y} + y_t) - (\bar{Y} - \hat{\beta}_1 \bar{X}) - \hat{\beta}_1 (\bar{X} + x_t) \right] (\bar{X} + x_t)
\]

### 步骤3：化简括号内项
展开并消去同类项：
\[
(\bar{Y} + y_t) - \bar{Y} + \hat{\beta}_1 \bar{X} - \hat{\beta}_1 \bar{X} - \hat{\beta}_1 x_t = y_t - \hat{\beta}_1 x_t
\]

此时方程（1）简化为：
\[
\sum_{t=1}^T (y_t - \hat{\beta}_1 x_t) (\bar{X} + x_t) = 0
\]

### 步骤4：展开求和并利用中心化性质
将求和拆分为两项：
\[
\sum_{t=1}^T y_t (\bar{X} + x_t) - \hat{\beta}_1 \sum_{t=1}^T x_t (\bar{X} + x_t) = 0
\]

进一步拆分并应用$ \sum x_t = 0 $、$ \sum y_t = 0 $（中心化变量和为0）：
\[
\bar{X} \underbrace{\sum y_t}_{=0} + \sum x_t y_t - \hat{\beta}_1 \bar{X} \underbrace{\sum x_t}_{=0} - \hat{\beta}_1 \sum x_t^2 = 0
\]

消去为0的项后剩余：
\[
\sum x_t y_t - \hat{\beta}_1 \sum x_t^2 = 0
\]

### 步骤5：解出β₁̂
由于$ \sum x_t^2 \neq 0 $（否则X无变异，模型无意义），两边除以$ \sum x_t^2 $：
\[
\hat{\beta}_1 = \frac{\sum_{t=1}^T x_t y_t}{\sum_{t=1}^T x_t^2}
\]


```python

```


```python

```
